<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hotel Booking Analytics</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f2f2f2;
            padding: 20px;
        }
        h1 {
            text-align: center;
        }
        .container {
            max-width: 900px;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
        }
        form {
            margin-bottom: 30px;
        }
        input[type="text"], select {
            width: 100%;
            padding: 10px;
            margin-top: 8px;
            margin-bottom: 16px;
            border: 1px solid #ccc;
            border-radius: 6px;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        .results {
            background: #f9f9f9;
            border-left: 4px solid #4CAF50;
            padding: 15px;
            margin-top: 10px;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Hotel Booking Analytics Dashboard</h1>

        <!-- Ask Endpoint -->
        <form id="ask-form">
            <h2>Ask a Question</h2>
            <input type="text" id="query" name="query" placeholder="Ask something like 'What is the average lead time?'" required>
            <button type="submit">Ask</button>
            <div id="ask-result" class="results"></div>
        </form>

        <!-- Analytics Endpoint -->
        <form id="analytics-form">
            <h2>Select Analytics Metrics</h2>
            <label for="metrics">Choose one or more metrics:</label>
            <select id="metrics" name="metrics" multiple size="6" required>
                <option value="revenue_trends">Revenue Trends</option>
                <option value="cancellation_rate">Cancellation Rate</option>
                <option value="lead_time_analysis">Lead Time Analysis</option>
                <option value="customer_segmentation">Customer Segmentation</option>
                <option value="waitlist_analysis">Waitlist Analysis</option>
                <option value="geographical_distribution">Geographical Distribution</option>
            </select>
            <button type="submit">Get Analytics</button>
            <div id="analytics-result" class="results"></div>
        </form>
    </div>

    <script>
        // Ask endpoint handler
        document.getElementById('ask-form').addEventListener('submit', async function (e) {
            e.preventDefault();
            const query = document.getElementById('query').value;
            const res = await fetch('/ask', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({query})
            });
            const data = await res.json();
            document.getElementById('ask-result').textContent = data.answer || 'No answer returned.';
        });

        // Analytics endpoint handler
        document.getElementById('analytics-form').addEventListener('submit', async function (e) {
            e.preventDefault();
            const selectedOptions = Array.from(document.getElementById('metrics').selectedOptions).map(o => o.value);
            const res = await fetch('/analytics', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({metrics: selectedOptions})
            });
            const data = await res.json();
            document.getElementById('analytics-result').textContent = JSON.stringify(data.analytics, null, 2);
        });
    </script>
</body>
</html>
